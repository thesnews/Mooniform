(function(){Mooniform={_elements:[],updateAll:function(){this._elements.each(function(b){b.retrieve("mooniform").update()})},resetAll:function(){this._elements.each(function(b){b.retrieve("mooniform").reset()})},mooniform:new Class({_defaults:$H({selectClass:"selector",radioClass:"radio",checkboxClass:"checker",fileClass:"uploader",filenameClass:"filename",fileBtnClass:"action",fileDefaultText:"No file selected",fileBtnText:"Choose File",checkedClass:"checked",focusClass:"focus",disabledClass:"disabled",
activeClass:"active",hoverClass:"hover",useID:true,idPrefix:"mooniform",resetSelector:false}),_type:false,_options:$H({}),_element:false,_supportOpacity:true,_defaultState:{disabled:false,value:false,checked:false},initialize:function(b,a){this._options=a?$H(a).combine(this._defaults):this._defaults;if(b)this._element=$(b);Mooniform._elements.push(this._element);this._defaultState={disabled:this._element.get("disabled"),value:this._element.get("value"),checked:this._element.get("checked")};this.styleize()},
styleize:function(b){var a=this._element;if(b)a=$(b);if(a.get("tag")=="select"){this._select(a);this._type="select"}else if(a.get("tag")=="input")switch(a.get("type")){case "file":this._file(a);this._type="file";break;case "checkbox":this._checkbox(a);this._type="checkbox";break;case "radio":this._radio(a);this._type="radio";break}},update:function(){switch(this._type){case "select":case "file":this._element.fireEvent("change");break;case "checkbox":case "radio":this._element.fireEvent("click");break}this._element.get("disabled")?
this._element.getParents("div")[0].addClass(this._options.get("disabledClass")):this._element.getParents("div")[0].removeClass(this._options.get("disabledClass"))},reset:function(){this._defaultState.value&&this._element.set("value",this._defaultState.value);this._defaultState.disabled?this._element.set("disabled",true):this._element.set("disabled",false);this._defaultState.checked?this._element.set("checked",true):this._element.set("checked",false);this.update()},_select:function(b){var a=new Element("div"),
d=new Element("span");a.addClass(this._options.get("selectClass"));this._options.get("useID")&&b.get("id")&&a.set("id",this._options.get("idPrefix")+"-"+b.get("id"));b.getSelected().length?d.set("text",b.getSelected()[0].get("text")):d.set("text",b.getChildren()[0].get("text"));b.setStyle("opacity",0.01);a.wraps(b);d.inject(a,"top");var c=this;b.addEvents({change:function(){d.set("text",b.getSelected()[0].get("text"));a.removeClass(c._options.get("activeClass"))},focus:function(){a.addClass(c._options.get("focusClass"))},
blur:function(){a.removeClass(c._options.get("focusClass"));a.removeClass(c._options.get("activeClass"))},mousedown:function(){a.addClass(c._options.get("activeClass"))},mouseup:function(){a.removeClass(c._options.get("activeClass"))},click:function(){a.removeClass(c._options.get("activeClass"))},hover:function(){a.addClass(c._options.get("hoverClass"))},keyup:function(){d.set("text",b.getSelected()[0].get("text"))}});b.get("disabled")&&a.addClass(this._options.get("disabledClass"));this._noSelect(d)},
_file:function(b){var a=new Element("div"),d=new Element("span"),c=new Element("span");d.set("text",this._options.get("fileDefaultText"));c.set("text",this._options.get("fileBtnText"));a.addClass(this._options.get("fileClass"));d.addClass(this._options.get("filenameClass"));c.addClass(this._options.get("fileBtnClass"));this._options.get("useID")&&b.get("id")&&a.set("id",this._options.get("idPrefix")+"-"+b.get("id"));a.wraps(b);c.inject(b,"after");d.inject(b,"after");b.get("size")||b.set("size",a.getCoordinates().width/
10);b.setStyle("opacity",0.01);var e=this;b.addEvents({focus:function(){a.addClass(e._options.get("focusClass"))},blur:function(){a.removeClass(e._options.get("removeClass"))},change:function(){var f="";if(b.get("value")){f=b.get("value").split(/[\/\\]+/);f=f[f.length-1]}else f=e._options.get("fileDefaultText");d.set("text",f)},mousedown:function(){b.get("disabled")||a.addClass(e._options.get("activeClass"))},mouseup:function(){a.removeClass(e._options.get("activeClass"))},mouseenter:function(){a.addClass(e._options.get("hoverClass"))},
mouseleave:function(){a.removeClass(e._options.get("hoverClass"))}});b.get("disabled")&&a.addClass(this._options.get("disabledClass"));this._noSelect(d);this._noSelect(c)},_checkbox:function(b){var a=new Element("div"),d=new Element("span");a.addClass(this._options.get("checkboxClass"));this._options.get("useID")&&b.get("id")&&a.set("id",this._options.get("idPrefix")+"-"+b.get("id"));a.wraps(b);d.wraps(b);b.setStyle("opacity",0.01);var c=this;b.addEvents({focus:function(){a.addClass(c._options.get("focusClass"))},
blur:function(){a.removeClass(c._options.get("focusClass"))},click:function(){this.get("checked")?d.addClass(c._options.get("checkedClass")):d.removeClass(c._options.get("checkedClass"))},mousedown:function(){a.addClass(c._options.get("activeClass"))},mouseup:function(){a.removeClass(c._options.get("activeClass"))},mouseenter:function(){a.addClass(c._options.get("hoverClass"))},mouseleave:function(){a.removeClass(c._options.get("hoverClass"))}});b.get("checked")&&d.addClass(this._options.get("checkedClass"));
b.get("disabled")&&a.addClass(this._options.get("disabledClass"))},_radio:function(b){var a=new Element("div"),d=new Element("span");a.addClass(this._options.get("radioClass"));d.set("name",b.get("name"));this._options.get("useID")&&b.get("id")&&a.set("id",this._options.get("idPrefix")+"-"+b.get("id"));a.wraps(b);d.wraps(b);b.setStyle("opacity",0.01);var c=this;b.addEvents({focus:function(){a.addClass(c._options.get("focusClass"))},blur:function(){a.removeClass(c._options.get("focusClass"))},click:function(){$$("."+
c._options.get("radioClass")+" span."+c._options.get("checkedClass")+"[name="+this.get("name")+"]").removeClass(c._options.get("checkedClass"));d.addClass(c._options.get("checkedClass"))},mousedown:function(){this.get("disabled")||a.addClass(c._options.get("activeClass"))},mouseup:function(){a.removeClass(c._options.get("activeClass"))},mouseenter:function(){a.addClass(c._options.get("hoverClass"))},mouseleave:function(){a.removeClass(c._options.get("hoverClass"))}});b.get("checked")&&d.addClass(this._options.get("checkedClass"));
b.get("disabled")&&a.addClass(this._options.get("disabledClass"))},_noSelect:function(b){b.onselectstart=this.ontragstart=$lambda(false);b.addEvent("mousedown",$lambda(false));b.setStyle("-moz-user-select","none")}})};Element.implement({mooniform:function(b){var a={};if(b)a=b;this.store("mooniform",new Mooniform.mooniform(this,a));return this}})})();